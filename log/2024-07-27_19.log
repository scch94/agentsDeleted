[2024-07-27 19:08:48.379] [Gconfiguration] [] [info] [] ending to get the configuration
[2024-07-27 19:08:48.379] [Gconfiguration] [] [trace] [] this is the data that we have in the configuration {"log_level":"trace","log_name":"agentsDeleted_","database_connection_string":"postgres://xxepin:migracion@digicel-dev-flex.postgres.database.azure.com:5432/xxepin?sslmode=require","tenant":4,"ubication_agents_file":"../utils/agents.txt"}
[2024-07-27 19:08:49.284] [agentsdeleter] [databaseConnection] [info] [] connected to postgres database
[2024-07-27 19:08:49.284] [agentsdeleter] [fileReader] [info] [] starting to get the agents  ubication of the file is ../utils/agents.txt
[2024-07-27 19:08:49.288] [agentsdeleter] [main] [info] [] number of agents are 4
[2024-07-27 19:08:49.288] [agentsdeleter] [controller] [info] [] starting to create the script to delete agents_mobile
[2024-07-27 19:08:49.288] [agentsdeleter] [controller] [trace] [] starting to get agents_msisdn info
[2024-07-27 19:08:49.289] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :996008814335
[2024-07-27 19:08:49.289] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A INNER JOIN agent_mobile AM ON AM.AGENT_OID=A.OID INNER JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=996008814335, and tenant_oid=4
[2024-07-27 19:08:50.045] [agentsdeleter] [database] [info] [] the query in the database tooks: 755.3816ms
[2024-07-27 19:08:50.045] [agentsdeleter] [controller] [trace] [] the agent with id 996008814335 has 1 moviles
[2024-07-27 19:08:50.045] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :104
[2024-07-27 19:08:50.045] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A INNER JOIN agent_mobile AM ON AM.AGENT_OID=A.OID INNER JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=104, and tenant_oid=4
[2024-07-27 19:08:50.781] [agentsdeleter] [database] [info] [] the query in the database tooks: 735.9356ms
[2024-07-27 19:08:50.781] [agentsdeleter] [controller] [trace] [] the agent with id 104 has 0 moviles
[2024-07-27 19:08:50.781] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :996008814232
[2024-07-27 19:08:50.782] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A INNER JOIN agent_mobile AM ON AM.AGENT_OID=A.OID INNER JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=996008814232, and tenant_oid=4
[2024-07-27 19:08:51.526] [agentsdeleter] [database] [info] [] the query in the database tooks: 744.7079ms
[2024-07-27 19:08:51.526] [agentsdeleter] [controller] [trace] [] the agent with id 996008814232 has 1 moviles
[2024-07-27 19:08:51.527] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :162
[2024-07-27 19:08:51.527] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A INNER JOIN agent_mobile AM ON AM.AGENT_OID=A.OID INNER JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=162, and tenant_oid=4
[2024-07-27 19:08:52.279] [agentsdeleter] [database] [info] [] the query in the database tooks: 752.0981ms
[2024-07-27 19:08:52.279] [agentsdeleter] [controller] [trace] [] the agent with id 162 has 0 moviles
[2024-07-27 19:08:52.280] [agentsdeleter] [queryBuilder] [info] [] starting to create a query to delete data to the table agent_mobile_pin
[2024-07-27 19:08:52.280] [agentsdeleter] [fileWriter] [info] [] starting to write in the file ../scripts/agent_mobile_scripts.txt
[2024-07-27 19:08:52.282] [agentsdeleter] [fileWriter] [trace] [] end to wrtite in a file: 
[2024-07-27 19:08:52.282] [agentsdeleter] [controller] [info] [] query to delete agent mobile pin was created and writed
[2024-07-27 19:08:52.282] [agentsdeleter] [queryBuilder] [info] [] starting to create a query to delete data to the table agent_mobile
[2024-07-27 19:08:52.282] [agentsdeleter] [fileWriter] [info] [] starting to write in the file ../scripts/agent_mobile_scripts.txt
[2024-07-27 19:08:52.283] [agentsdeleter] [fileWriter] [trace] [] end to wrtite in a file: 
[2024-07-27 19:08:52.284] [agentsdeleter] [controller] [info] [] query to delete agent mobile was created and writed
[2024-07-27 19:08:52.284] [agentsdeleter] [controller] [info] [] starting to create the script to delete Users vinculated to the agents in the list
[2024-07-27 19:08:52.284] [agentsdeleter] [controller] [trace] [] starting to get users
[2024-07-27 19:08:52.284] [agentsdeleter] [controller] [info] [] AGENTS:%!(EXTRA *[]modelUtils.Agents=&[{996008814335 113771 0 {true }} {104  0 {true }} {996008814232 4788 0 {true }} {162  0 {true }}])
[2024-07-27 19:08:52.285] [agentsdeleter] [database] [trace] [] starting to get the Users por the agent with oid :113771
[2024-07-27 19:08:52.285] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT ua.oid, ua.user_id, cu.client_oid FROM user_adm ua JOIN client_user cu ON ua.oid = cu.user_oid WHERE cu.client_oid = $1 AND cu.tenant_oid=$2 and the params: agentID=113771, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:53.013] [agentsdeleter] [database] [info] [] the query in the database tooks: 728.509ms
[2024-07-27 19:08:53.013] [agentsdeleter] [controller] [trace] [] the agent with id 996008814335 has 0 users
[2024-07-27 19:08:53.014] [agentsdeleter] [database] [trace] [] starting to get the Users por the agent with oid :
[2024-07-27 19:08:53.014] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT ua.oid, ua.user_id, cu.client_oid FROM user_adm ua JOIN client_user cu ON ua.oid = cu.user_oid WHERE cu.client_oid = $1 AND cu.tenant_oid=$2 and the params: agentID=, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:53.744] [agentsdeleter] [database] [error] [] query error pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:53.744] [agentsdeleter] [controller] [error] [] error in getUsers: pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:53.744] [agentsdeleter] [controller] [trace] [] the agent with id 104 has 0 users
[2024-07-27 19:08:53.745] [agentsdeleter] [database] [trace] [] starting to get the Users por the agent with oid :4788
[2024-07-27 19:08:53.745] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT ua.oid, ua.user_id, cu.client_oid FROM user_adm ua JOIN client_user cu ON ua.oid = cu.user_oid WHERE cu.client_oid = $1 AND cu.tenant_oid=$2 and the params: agentID=4788, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:54.510] [agentsdeleter] [database] [info] [] the query in the database tooks: 765.0203ms
[2024-07-27 19:08:54.510] [agentsdeleter] [controller] [trace] [] the agent with id 996008814232 has 0 users
[2024-07-27 19:08:54.510] [agentsdeleter] [database] [trace] [] starting to get the Users por the agent with oid :
[2024-07-27 19:08:54.511] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT ua.oid, ua.user_id, cu.client_oid FROM user_adm ua JOIN client_user cu ON ua.oid = cu.user_oid WHERE cu.client_oid = $1 AND cu.tenant_oid=$2 and the params: agentID=, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:55.257] [agentsdeleter] [database] [error] [] query error pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [error] [] error in getUsers: pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [trace] [] the agent with id 162 has 0 users
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [info] [] usuarios : [] agentes &[{996008814335 113771 0 {true }} {104  0 {true }} {996008814232 4788 0 {true }} {162  0 {true }}]
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [info] [] No users to delete
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [info] [] starting to create the script to delete agents 
[2024-07-27 19:08:55.257] [agentsdeleter] [controller] [trace] [] checking if the agents have a credit different than 0
[2024-07-27 19:08:55.258] [agentsdeleter] [controller] [info] [] check credit accounts finish
[2024-07-27 19:08:55.258] [agentsdeleter] [controller] [trace] [] checking if the agents are parents
[2024-07-27 19:08:55.258] [agentsdeleter] [database] [trace] [] starting to check if the Agent whit id 996008814335 is a parent 
[2024-07-27 19:08:55.258] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT * FROM agent WHERE parent_oid= $1 AND tenant_oid= $2 limit 1 and the params: agentID=113771, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:55.958] [agentsdeleter] [database] [info] [] Agent 113771 is not a parent and can be deleted
[2024-07-27 19:08:55.958] [agentsdeleter] [database] [info] [] the query in the database tooks: 699.9468ms
[2024-07-27 19:08:55.958] [agentsdeleter] [database] [trace] [] starting to check if the Agent whit id 104 is a parent 
[2024-07-27 19:08:55.958] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT * FROM agent WHERE parent_oid= $1 AND tenant_oid= $2 limit 1 and the params: agentID=, and tenant_oid=%!s(int=4)
[2024-07-27 19:08:56.692] [agentsdeleter] [database] [error] [] query error pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:56.692] [agentsdeleter] [controller] [error] [] error in the database function IsAgentParent err: pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:56.693] [agentsdeleter] [controller] [error] [] error in the function isAgentsParent() err: pq: invalid input syntax for type bigint: ""
[2024-07-27 19:08:56.693] [agentsdeleter] [main] [error] [] error creating the script to delete the users of the agents: pq: invalid input syntax for type bigint: ""
[2024-07-27 19:18:02.804] [Gconfiguration] [] [info] [] ending to get the configuration
[2024-07-27 19:18:02.805] [Gconfiguration] [] [trace] [] this is the data that we have in the configuration {"log_level":"trace","log_name":"agentsDeleted_","database_connection_string":"postgres://xxepin:migracion@digicel-dev-flex.postgres.database.azure.com:5432/xxepin?sslmode=require","tenant":4,"ubication_agents_file":"../utils/agents.txt"}
[2024-07-27 19:18:03.974] [agentsdeleter] [databaseConnection] [info] [] connected to postgres database
[2024-07-27 19:18:03.974] [agentsdeleter] [fileReader] [info] [] starting to get the agents  ubication of the file is ../utils/agents.txt
[2024-07-27 19:18:03.978] [agentsdeleter] [main] [info] [] number of agents are 4
[2024-07-27 19:18:03.978] [agentsdeleter] [controller] [info] [] starting to create the script to delete agents_mobile
[2024-07-27 19:18:03.978] [agentsdeleter] [controller] [trace] [] starting to get agents_msisdn info
[2024-07-27 19:18:03.979] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :996008814335
[2024-07-27 19:18:03.979] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A FULL JOIN agent_mobile AM ON AM.AGENT_OID=A.OID FULL JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=996008814335, and tenant_oid=4
[2024-07-27 19:18:04.719] [agentsdeleter] [database] [info] [] the query in the database tooks: 739.7404ms
[2024-07-27 19:18:04.719] [agentsdeleter] [controller] [trace] [] the agent with id 996008814335 has 1 moviles
[2024-07-27 19:18:04.720] [agentsdeleter] [database] [trace] [] starting to get the msisdn por the agent with id :104
[2024-07-27 19:18:04.720] [agentsdeleter] [database] [trace] [] this is the QUERY: SELECT AM.OID, A.OID, MSISDN, ACC.CREDIT FROM agent A FULL JOIN agent_mobile AM ON AM.AGENT_OID=A.OID FULL JOIN account ACC ON ACC.AGENT_OID = A.OID WHERE A.AGENT_ID=$1 AND A.TENANT_OID=$2 and the params: agentID=104, and tenant_oid=4
[2024-07-27 19:18:05.440] [agentsdeleter] [database] [error] [] error scanning row: sql: Scan error on column index 0, name "oid": converting NULL to string is unsupported
[2024-07-27 19:18:05.440] [agentsdeleter] [controller] [error] [] error in getmsisdn: sql: Scan error on column index 0, name "oid": converting NULL to string is unsupported
[2024-07-27 19:18:05.441] [agentsdeleter] [controller] [error] [] error on the function getAgentsInfo() err: sql: Scan error on column index 0, name "oid": converting NULL to string is unsupported
[2024-07-27 19:18:05.441] [agentsdeleter] [main] [error] [] error creating the script to delete the msisdns of the agents: sql: Scan error on column index 0, name "oid": converting NULL to string is unsupported
